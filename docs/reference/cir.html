<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Identify pixels in a circle or ring (donut) around an object. — cir • SpaDES.tools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Identify pixels in a circle or ring (donut) around an object. — cir" />
<meta property="og:description" content="Identify the pixels and coordinates that are at a (set of) buffer distance(s)
of the objects passed into coords.
This is similar to rgeos::gBuffer but much faster and without
the geo referencing information.
In other words, it can be used for similar problems, but where speed is important.
This code is substantially adapted from PlotRegionHighlighter::createCircle." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SpaDES.tools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PredictiveEcology/SpaDES.tools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify pixels in a circle or ring (donut) around an object.</h1>
    <small class="dont-index">Source: <a href='https://github.com/PredictiveEcology/SpaDES.tools/blob/master/R/neighbourhood.R'><code>R/neighbourhood.R</code></a></small>
    <div class="hidden name"><code>cir.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Identify the pixels and coordinates that are at a (set of) buffer distance(s)
of the objects passed into <code>coords</code>.
This is similar to <code><a href='https://rdrr.io/pkg/rgeos/man/misc-gBuffer.html'>rgeos::gBuffer</a></code> but much faster and without
the geo referencing information.
In other words, it can be used for similar problems, but where speed is important.
This code is substantially adapted from <code>PlotRegionHighlighter::createCircle</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>cir</span><span class='op'>(</span>
  <span class='va'>landscape</span>,
  <span class='va'>coords</span>,
  <span class='va'>loci</span>,
  maxRadius <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/ncell.html'>ncol</a></span><span class='op'>(</span><span class='va'>landscape</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>4</span>,
  minRadius <span class='op'>=</span> <span class='va'>maxRadius</span>,
  allowOverlap <span class='op'>=</span> <span class='cn'>TRUE</span>,
  allowDuplicates <span class='op'>=</span> <span class='cn'>FALSE</span>,
  includeBehavior <span class='op'>=</span> <span class='st'>"includePixels"</span>,
  returnDistances <span class='op'>=</span> <span class='cn'>FALSE</span>,
  angles <span class='op'>=</span> <span class='cn'>NA_real_</span>,
  returnAngles <span class='op'>=</span> <span class='cn'>FALSE</span>,
  returnIndices <span class='op'>=</span> <span class='cn'>TRUE</span>,
  closest <span class='op'>=</span> <span class='cn'>FALSE</span>,
  simplify <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>landscape</th>
      <td><p>Raster on which the circles are built.</p></td>
    </tr>
    <tr>
      <th>coords</th>
      <td><p>Either a matrix with 2 (or 3) columns, x and y (and id), representing the
coordinates (and an associated id, like cell index),
or a <code>SpatialPoints*</code> object around which to make circles. Must be same
coordinate system as the <code>landscape</code> argument. Default is missing,
meaning it uses the default to <code>loci</code></p></td>
    </tr>
    <tr>
      <th>loci</th>
      <td><p>Numeric. An alternative to <code>coords</code>. These are the indices on
<code>landscape</code> to initiate this function. See <code>coords</code>. Default is one
point in centre of <code>landscape</code>..</p></td>
    </tr>
    <tr>
      <th>maxRadius</th>
      <td><p>Numeric vector of length 1 or same length as coords</p></td>
    </tr>
    <tr>
      <th>minRadius</th>
      <td><p>Numeric vector of length 1 or same length as <code>coords</code>. Default is
<code>maxRadius</code>, meaning return all cells that are touched
by the narrow ring at that exact radius. If smaller than <code>maxRadius</code>,
then this will create a buffer or donut or ring.</p></td>
    </tr>
    <tr>
      <th>allowOverlap</th>
      <td><p>Logical. Should duplicates across id be removed or kept. Default TRUE.</p></td>
    </tr>
    <tr>
      <th>allowDuplicates</th>
      <td><p>Logical. Should duplicates within id be removed or kept. Default FALSE.
This is useful if the actual x, y coordinates are desired, rather
than the cell indices. This will increase the size of the returned
object.</p></td>
    </tr>
    <tr>
      <th>includeBehavior</th>
      <td><p>Character string. Currently accepts only "includePixels", the default,
and "excludePixels". See details.</p></td>
    </tr>
    <tr>
      <th>returnDistances</th>
      <td><p>Logical. If TRUE, then a column will be added to the returned
data.table that reports the distance from <code>coords</code> to every
point that was in the circle/donut surrounding <code>coords</code>. Default
FALSE, which is faster.</p></td>
    </tr>
    <tr>
      <th>angles</th>
      <td><p>Numeric. Optional vector of angles, in radians, to use. This will create
"spokes" outward from coords. Default is NA, meaning, use internally
derived angles that will "fill" the circle.</p></td>
    </tr>
    <tr>
      <th>returnAngles</th>
      <td><p>Logical. If TRUE, then a column will be added to the returned
data.table that reports the angle from <code>coords</code> to every
point that was in the circle/donut surrounding <code>coords</code>. Default
FALSE.</p></td>
    </tr>
    <tr>
      <th>returnIndices</th>
      <td><p>Logical or numeric. If <code>1</code> or <code>TRUE</code>, will
return a <code>data.table</code> with indices and values of
successful spread events.
If <code>2</code>, it will simply return a vector of pixel indices of
all cells that were touched. This will be the fastest option. If
<code>FALSE</code>, then it will return a raster with
values. See Details.</p></td>
    </tr>
    <tr>
      <th>closest</th>
      <td><p>Logical. When determining non-overlapping circles, should the function
give preference to the closest <code>loci</code> or the first one (much faster).
Default is FALSE, meaning the faster, though maybe not desired behaviour.</p></td>
    </tr>
    <tr>
      <th>simplify</th>
      <td><p>logical. If TRUE, then all duplicate pixels are removed. This means
that some x, y combinations will disappear.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>matrix</code> with 4 columns, <code>id</code>, <code>indices</code>,
<code>x</code>, <code>y</code>. The <code>x</code> and <code>y</code> indicate the exact coordinates of
the <code>indices</code> (i.e., cell number) of the <code>landscape</code>
associated with the ring or circle being identified by this function.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function identifies all the pixels as defined by a donut
with inner radius <code>minRadius</code> and outer radius of <code>maxRadius</code>.
The <code>includeBehavior</code> defines whether the cells that intersect the radii
but whose centres are not inside the donut are included <code>includePixels</code>
or not <code>excludePixels</code> in the returned pixels identified.
If this is <code>excludePixels</code>, and if a <code>minRadius</code> and
<code>maxRadius</code> are equal, this will return no pixels.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='rings.html'>rings</a></code> which uses <code>spread</code> internally.
<code>cir</code> tends to be faster when there are few starting points, <code>rings</code>
tends to be faster when there are many starting points. <code>cir</code> scales with
<code>maxRadius</code> ^ 2 and <code>coords</code>. Another difference
between the two functions is that <code>rings</code> takes the centre of the pixel
as the centre of a circle, whereas <code>cir</code> takes the exact coordinates.
See example. For the specific case of creating distance surfaces from specific
points, see <code><a href='distanceFromEachPoint.html'>distanceFromEachPoint</a></code>, which is often faster.
For the more general GIS buffering, see <code><a href='https://rdrr.io/pkg/rgeos/man/misc-gBuffer.html'>rgeos::gBuffer</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-datatable.com'>data.table</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘data.table’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:raster’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    shift</span></div><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/edzer/sp/'>sp</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rspatial.org/raster'>raster</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://quickplot.predictiveecology.org'>quickPlot</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1462</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://www.wim.uni-mannheim.de/schlather/publications/software'>RandomFields</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># circle centred</span>
  <span class='va'>ras</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>15</span>, <span class='fl'>0</span>, <span class='fl'>15</span><span class='op'>)</span>, res <span class='op'>=</span> <span class='fl'>1</span>, val <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
  <span class='va'>middleCircle</span> <span class='op'>&lt;-</span> <span class='fu'>cir</span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span>
  <span class='va'>ras</span><span class='op'>[</span><span class='va'>middleCircle</span><span class='op'>[</span>, <span class='st'>"indices"</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  <span class='va'>circlePoints</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPoints</a></span><span class='op'>(</span><span class='va'>middleCircle</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/pkg/RandomFields/man/QMath.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/clearPlot.html'>clearPlot</a></span><span class='op'>(</span><span class='op'>)</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span><span class='op'>(</span><span class='va'>circlePoints</span>, addTo <span class='op'>=</span> <span class='st'>"ras"</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='co'># circles non centred</span>
  <span class='va'>ras</span> <span class='op'>&lt;-</span> <span class='fu'><a href='randomPolygons.html'>randomPolygons</a></span><span class='op'>(</span><span class='va'>ras</span>, numTypes <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
  <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>
  <span class='va'>agent</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPoints</a></span><span class='op'>(</span>coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmin</a></span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmax</a></span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span><span class='op'>)</span>,
                                        y <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmin</a></span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmax</a></span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

  <span class='va'>cirs</span> <span class='op'>&lt;-</span> <span class='fu'>cir</span><span class='op'>(</span><span class='va'>ras</span>, <span class='va'>agent</span>, maxRadius <span class='op'>=</span> <span class='fl'>15</span>, simplify <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='co'>## TODO: empty with some seeds! e.g. 1642</span>
  <span class='va'>cirsSP</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPoints</a></span><span class='op'>(</span>coords <span class='op'>=</span> <span class='va'>cirs</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/pkg/RandomFields/man/QMath.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span> <span class='co'>## TODO: error with some seeds! e.g. 1642</span>
  <span class='va'>cirsRas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span>
  <span class='va'>cirsRas</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  <span class='va'>cirsRas</span><span class='op'>[</span><span class='va'>cirs</span><span class='op'>[</span>, <span class='st'>"indices"</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>

  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/clearPlot.html'>clearPlot</a></span><span class='op'>(</span><span class='op'>)</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span><span class='op'>(</span><span class='va'>cirsRas</span>, addTo <span class='op'>=</span> <span class='st'>"ras"</span>, cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/RandomFields/man/QMath.html'>c</a></span><span class='op'>(</span><span class='st'>"transparent"</span>, <span class='st'>"#00000055"</span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span><span class='op'>(</span><span class='va'>agent</span>, addTo <span class='op'>=</span> <span class='st'>"ras"</span><span class='op'>)</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span><span class='op'>(</span><span class='va'>cirsSP</span>, addTo <span class='op'>=</span> <span class='st'>"ras"</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='co'># Example comparing rings and cir</span>
  <span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>30</span>, <span class='fl'>0</span>, <span class='fl'>30</span><span class='op'>)</span>, res <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
  <span class='va'>hab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='gaussMap.html'>gaussMap</a></span><span class='op'>(</span><span class='va'>a</span>, speedup <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='co'># if raster is large (&gt;1e6 pixels) use speedup &gt; 1</span>
  <span class='va'>radius</span> <span class='op'>&lt;-</span> <span class='fl'>4</span>
  <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>
  <span class='va'>coords</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPoints</a></span><span class='op'>(</span>coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmin</a></span><span class='op'>(</span><span class='va'>hab</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmax</a></span><span class='op'>(</span><span class='va'>hab</span><span class='op'>)</span><span class='op'>)</span>,
                                         y <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmin</a></span><span class='op'>(</span><span class='va'>hab</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmax</a></span><span class='op'>(</span><span class='va'>hab</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

  <span class='co'># cirs</span>
  <span class='va'>cirs</span> <span class='op'>&lt;-</span> <span class='fu'>cir</span><span class='op'>(</span><span class='va'>hab</span>, <span class='va'>coords</span>, maxRadius <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>radius</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>coords</span><span class='op'>)</span><span class='op'>)</span>, simplify <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

  <span class='co'># rings</span>
  <span class='va'>loci</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/cellFrom.html'>cellFromXY</a></span><span class='op'>(</span><span class='va'>hab</span>, <span class='fu'><a href='https://rdrr.io/pkg/sp/man/coordinates.html'>coordinates</a></span><span class='op'>(</span><span class='va'>coords</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>cirs2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rings.html'>rings</a></span><span class='op'>(</span><span class='va'>hab</span>, <span class='va'>loci</span>, maxRadius <span class='op'>=</span> <span class='va'>radius</span>, minRadius <span class='op'>=</span> <span class='va'>radius</span> <span class='op'>-</span> <span class='fl'>1</span>, returnIndices <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

  <span class='co'># Plot both</span>
  <span class='va'>ras1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='va'>hab</span><span class='op'>)</span>
  <span class='va'>ras1</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  <span class='va'>ras1</span><span class='op'>[</span><span class='va'>cirs</span><span class='op'>[</span>, <span class='st'>"indices"</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>cirs</span><span class='op'>[</span>, <span class='st'>"id"</span><span class='op'>]</span>

  <span class='va'>ras2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='va'>hab</span><span class='op'>)</span>
  <span class='va'>ras2</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  <span class='va'>ras2</span><span class='op'>[</span><span class='va'>cirs2</span><span class='op'>$</span><span class='va'>indices</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>cirs2</span><span class='op'>$</span><span class='va'>id</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/clearPlot.html'>clearPlot</a></span><span class='op'>(</span><span class='op'>)</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span><span class='op'>(</span><span class='va'>ras1</span>, <span class='va'>ras2</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span>, <span class='fl'>0</span>, <span class='fl'>100</span><span class='op'>)</span>, res <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
  <span class='va'>hab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='gaussMap.html'>gaussMap</a></span><span class='op'>(</span><span class='va'>a</span>, speedup <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
  <span class='va'>cirs</span> <span class='op'>&lt;-</span> <span class='fu'>cir</span><span class='op'>(</span><span class='va'>hab</span>, <span class='va'>coords</span>, maxRadius <span class='op'>=</span> <span class='fl'>44</span>, minRadius <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
  <span class='va'>ras1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='va'>hab</span><span class='op'>)</span>
  <span class='va'>ras1</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  <span class='va'>cirsOverlap</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></span><span class='op'>(</span><span class='va'>cirs</span><span class='op'>)</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sumIDs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='va'>indices</span><span class='op'>]</span>
  <span class='va'>ras1</span><span class='op'>[</span><span class='va'>cirsOverlap</span><span class='op'>$</span><span class='va'>indices</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>cirsOverlap</span><span class='op'>$</span><span class='va'>sumIDs</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/clearPlot.html'>clearPlot</a></span><span class='op'>(</span><span class='op'>)</span>
    <span class='fu'><a href='http://quickplot.predictiveecology.org//reference/Plot.html'>Plot</a></span><span class='op'>(</span><span class='va'>ras1</span><span class='op'>)</span>
  <span class='op'>}</span>

  <span class='co'># Provide a specific set of angles</span>
  <span class='va'>ras</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/extent.html'>extent</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>330</span>, <span class='fl'>0</span>, <span class='fl'>330</span><span class='op'>)</span>, res <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
  <span class='va'>ras</span><span class='op'>[</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>
  <span class='va'>coords</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmin</a></span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmax</a></span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span><span class='op'>)</span>,
                  y <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmin</a></span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/pkg/raster/man/coordinates.html'>xmax</a></span><span class='op'>(</span><span class='va'>ras</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>circ</span> <span class='op'>&lt;-</span> <span class='fu'>cir</span><span class='op'>(</span><span class='va'>ras</span>, <span class='va'>coords</span>, angles <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>pi</span>, length.out <span class='op'>=</span> <span class='fl'>21</span><span class='op'>)</span>,
              maxRadius <span class='op'>=</span> <span class='fl'>200</span>, minRadius <span class='op'>=</span> <span class='fl'>0</span>, returnIndices <span class='op'>=</span> <span class='cn'>FALSE</span>,
              allowOverlap <span class='op'>=</span> <span class='cn'>TRUE</span>, returnAngles <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: RandomFields</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: RandomFieldsUtils</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘RandomFields’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:RandomFieldsUtils’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    RFoptions</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alex M Chubaty, Eliot J B McIntire.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


