<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Identify pixels in a circle or ring (donut) around an object. — cir • SpaDES.tools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Identify pixels in a circle or ring (donut) around an object. — cir"><meta property="og:description" content="Identify the pixels and coordinates that are at a (set of) buffer distance(s)
of the objects passed into coords.
This is similar to sf::st_buffer but much faster and without the geo referencing information.
In other words, it can be used for similar problems, but where speed is important.
This code is substantially adapted from PlotRegionHighlighter::createCircle."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SpaDES.tools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/PredictiveEcology/SpaDES.tools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify pixels in a circle or ring (donut) around an object.</h1>
    <small class="dont-index">Source: <a href="https://github.com/PredictiveEcology/SpaDES.tools/blob/HEAD/R/neighbourhood.R" class="external-link"><code>R/neighbourhood.R</code></a></small>
    <div class="hidden name"><code>cir.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Identify the pixels and coordinates that are at a (set of) buffer distance(s)
of the objects passed into <code>coords</code>.
This is similar to <code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">sf::st_buffer</a></code> but much faster and without the geo referencing information.
In other words, it can be used for similar problems, but where speed is important.
This code is substantially adapted from <code>PlotRegionHighlighter::createCircle</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cir</span><span class="op">(</span></span>
<span>  <span class="va">landscape</span>,</span>
<span>  <span class="va">coords</span>,</span>
<span>  <span class="va">loci</span>,</span>
<span>  maxRadius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">landscape</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span>,</span>
<span>  minRadius <span class="op">=</span> <span class="va">maxRadius</span>,</span>
<span>  allowOverlap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allowDuplicates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  includeBehavior <span class="op">=</span> <span class="st">"includePixels"</span>,</span>
<span>  returnDistances <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  angles <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  returnAngles <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  returnIndices <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  closest <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  simplify <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>landscape</dt>
<dd><p>Raster on which the circles are built.</p></dd>


<dt>coords</dt>
<dd><p>Either a matrix with 2 (or 3) columns, x and y (and id), representing the
coordinates (and an associated id, like cell index),
or a <code>SpatialPoints*</code> object around which to make circles. Must be same
coordinate system as the <code>landscape</code> argument. Default is missing,
meaning it uses the default to <code>loci</code></p></dd>


<dt>loci</dt>
<dd><p>Numeric. An alternative to <code>coords</code>. These are the indices on
<code>landscape</code> to initiate this function. See <code>coords</code>. Default is one
point in centre of <code>landscape</code>..</p></dd>


<dt>maxRadius</dt>
<dd><p>Numeric vector of length 1 or same length as coords</p></dd>


<dt>minRadius</dt>
<dd><p>Numeric vector of length 1 or same length as <code>coords</code>. Default is
<code>maxRadius</code>, meaning return all cells that are touched
by the narrow ring at that exact radius. If smaller than <code>maxRadius</code>,
then this will create a buffer or donut or ring.</p></dd>


<dt>allowOverlap</dt>
<dd><p>Logical. Should duplicates across id be removed or kept. Default TRUE.</p></dd>


<dt>allowDuplicates</dt>
<dd><p>Logical. Should duplicates within id be removed or kept. Default FALSE.
This is useful if the actual x, y coordinates are desired, rather
than the cell indices. This will increase the size of the returned
object.</p></dd>


<dt>includeBehavior</dt>
<dd><p>Character string. Currently accepts only <code>"includePixels"</code>, the default,
and <code>"excludePixels"</code>. See details.</p></dd>


<dt>returnDistances</dt>
<dd><p>Logical. If <code>TRUE</code>, then a column will be added to the returned
data.table that reports the distance from <code>coords</code> to every
point that was in the circle/donut surrounding <code>coords</code>. Default
<code>FALSE</code>, which is faster.</p></dd>


<dt>angles</dt>
<dd><p>Numeric. Optional vector of angles, in radians, to use. This will create
"spokes" outward from coords. Default is <code>NA</code>, meaning, use internally
derived angles that will "fill" the circle.</p></dd>


<dt>returnAngles</dt>
<dd><p>Logical. If <code>TRUE</code>, then a column will be added to the returned
data.table that reports the angle from <code>coords</code> to every
point that was in the circle/donut surrounding <code>coords</code>. Default <code>FALSE.</code></p></dd>


<dt>returnIndices</dt>
<dd><p>Logical or numeric. If <code>1</code> or <code>TRUE</code>, will return a <code>data.table</code>
with indices and values of successful spread events.
If <code>2</code>, it will simply return a vector of pixel indices of
all cells that were touched. This will be the fastest option.
If <code>FALSE</code>, then it will return a raster with values.
See Details.</p></dd>


<dt>closest</dt>
<dd><p>Logical. When determining non-overlapping circles, should the function
give preference to the closest <code>loci</code> or the first one (much faster).
Default is <code>FALSE</code>, meaning the faster, though maybe not desired behaviour.</p></dd>


<dt>simplify</dt>
<dd><p>logical. If <code>TRUE</code>, then all duplicate pixels are removed.
This means that some x, y combinations will disappear.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>matrix</code> with 4 columns, <code>id</code>, <code>indices</code>,
<code>x</code>, <code>y</code>. The <code>x</code> and <code>y</code> indicate the exact coordinates of
the <code>indices</code> (i.e., cell number) of the <code>landscape</code></p>


<p>associated with the ring or circle being identified by this function.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function identifies all the pixels as defined by a donut
with inner radius <code>minRadius</code> and outer radius of <code>maxRadius</code>.
The <code>includeBehavior</code> defines whether the cells that intersect the radii
but whose centres are not inside the donut are included <code>includePixels</code>
or not <code>excludePixels</code> in the returned pixels identified.
If this is <code>excludePixels</code>, and if a <code>minRadius</code> and
<code>maxRadius</code> are equal, this will return no pixels.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="rings.html">rings()</a></code> which uses <code>spread</code> internally.
<code>cir</code> tends to be faster when there are few starting points, <code>rings</code> tends to be faster
when there are many starting points. <code>cir</code> scales with <code>maxRadius^2</code> and <code>coords</code>.
Another difference between the two functions is that <code>rings</code> takes the centre of the pixel
as the centre of a circle, whereas <code>cir</code> takes the exact coordinates.
See example. For the specific case of creating distance surfaces from specific
points, see <code><a href="distanceFromEachPoint.html">distanceFromEachPoint()</a></code>, which is often faster.
For the more general GIS buffering, see <code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">sf::st_buffer</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">origThreads</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/openmp-utils.html" class="external-link">setDTthreads</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># for CRAN automated testing</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1462</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># circle centred</span></span></span>
<span class="r-in"><span><span class="va">ras</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">1</span>, val <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">middleCircle</span> <span class="op">&lt;-</span> <span class="fu">cir</span><span class="op">(</span><span class="va">ras</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ras</span><span class="op">[</span><span class="va">middleCircle</span><span class="op">[</span> , <span class="st">"indices"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">circlePoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">middleCircle</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># clearPlot()</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">circlePoints</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># circles non centred</span></span></span>
<span class="r-in"><span><span class="va">ras</span> <span class="op">&lt;-</span> <span class="fu"><a href="randomPolygons.html">randomPolygons</a></span><span class="op">(</span><span class="va">ras</span>, numTypes <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">agent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmin</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmax</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    y <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmin</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmax</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cirs</span> <span class="op">&lt;-</span> <span class="fu">cir</span><span class="op">(</span><span class="va">ras</span>, <span class="va">agent</span>, maxRadius <span class="op">=</span> <span class="fl">15</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">## TODO: empty with some seeds! e.g. 1642</span></span></span>
<span class="r-in"><span><span class="va">cirsSP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">cirs</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co">## TODO: error with some seeds! e.g. 1642</span></span></span>
<span class="r-in"><span><span class="va">cirsRas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cirsRas</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">cirsRas</span><span class="op">[</span><span class="va">cirs</span><span class="op">[</span>, <span class="st">"indices"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># clearPlot()</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cirsRas</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"transparent"</span>, <span class="st">"#00000055"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">agent</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cirsSP</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example comparing rings and cir</span></span></span>
<span class="r-in"><span><span class="va">hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"hab1.tif"</span>, package <span class="op">=</span> <span class="st">"SpaDES.tools"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">radius</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmin</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmax</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     y <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmin</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmax</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># cirs</span></span></span>
<span class="r-in"><span><span class="va">cirs</span> <span class="op">&lt;-</span> <span class="fu">cir</span><span class="op">(</span><span class="va">hab</span>, <span class="va">coords</span>, maxRadius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">radius</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ras1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ras1</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">ras1</span><span class="op">[</span><span class="va">cirs</span><span class="op">[</span>, <span class="st">"indices"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cirs</span><span class="op">[</span>, <span class="st">"id"</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ras1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rings</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"CircStats"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">loci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xyCellFrom.html" class="external-link">cellFromXY</a></span><span class="op">(</span><span class="va">hab</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/crds.html" class="external-link">crds</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">cirs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="rings.html">rings</a></span><span class="op">(</span><span class="va">hab</span>, <span class="va">loci</span>, maxRadius <span class="op">=</span> <span class="va">radius</span>, minRadius <span class="op">=</span> <span class="va">radius</span> <span class="op">-</span> <span class="fl">1</span>, returnIndices <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">ras2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ras2</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>  <span class="va">ras2</span><span class="op">[</span><span class="va">cirs2</span><span class="op">$</span><span class="va">indices</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cirs2</span><span class="op">$</span><span class="va">id</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ras1</span>, <span class="va">ras2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"hab2.tif"</span>, package <span class="op">=</span> <span class="st">"SpaDES.tools"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cirs</span> <span class="op">&lt;-</span> <span class="fu">cir</span><span class="op">(</span><span class="va">hab</span>, <span class="va">coords</span>, maxRadius <span class="op">=</span> <span class="fl">44</span>, minRadius <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ras1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ras1</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">cirsOverlap</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">cirs</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sumIDs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">indices</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">ras1</span><span class="op">[</span><span class="va">cirsOverlap</span><span class="op">$</span><span class="va">indices</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cirsOverlap</span><span class="op">$</span><span class="va">sumIDs</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ras1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Provide a specific set of angles</span></span></span>
<span class="r-in"><span><span class="va">ras</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">330</span>, <span class="fl">0</span>, <span class="fl">330</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ras</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmin</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmax</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                y <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmin</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmax</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">circ</span> <span class="op">&lt;-</span> <span class="fu">cir</span><span class="op">(</span><span class="va">ras</span>, <span class="va">coords</span>, angles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">21</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            maxRadius <span class="op">=</span> <span class="fl">200</span>, minRadius <span class="op">=</span> <span class="fl">0</span>, returnIndices <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>            allowOverlap <span class="op">=</span> <span class="cn">TRUE</span>, returnAngles <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># clean up</span></span></span>
<span class="r-in"><span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/openmp-utils.html" class="external-link">setDTthreads</a></span><span class="op">(</span><span class="va">origThreads</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Eliot J B McIntire, Alex M Chubaty.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

