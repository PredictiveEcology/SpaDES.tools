<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>An alternative spread function, conceived for insects — spread3 • SpaDES.tools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="An alternative spread function, conceived for insects — spread3"><meta property="og:description" content='This is built with spread2() and is still experimental.
This one differs from other attempts in that it treats the advection and
dispersal as mathematical vectors that are added together.
They are "rounded" to pixel centres.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SpaDES.tools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/PredictiveEcology/SpaDES.tools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>An alternative spread function, conceived for insects</h1>
    <small class="dont-index">Source: <a href="https://github.com/PredictiveEcology/SpaDES.tools/blob/HEAD/R/spread3.R" class="external-link"><code>R/spread3.R</code></a></small>
    <div class="hidden name"><code>spread3.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is built with <code><a href="spread2.html">spread2()</a></code> and is still experimental.
This one differs from other attempts in that it treats the advection and
dispersal as mathematical vectors that are added together.
They are "rounded" to pixel centres.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spread3</span><span class="op">(</span></span>
<span>  <span class="va">start</span>,</span>
<span>  <span class="va">rasQuality</span>,</span>
<span>  <span class="va">rasAbundance</span>,</span>
<span>  <span class="va">advectionDir</span>,</span>
<span>  <span class="va">advectionMag</span>,</span>
<span>  <span class="va">meanDist</span>,</span>
<span>  dispersalKernel <span class="op">=</span> <span class="st">"exponential"</span>,</span>
<span>  sdDist <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  plot.it <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  minNumAgents <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"LandR.verbose"</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  saveStack <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  skipChecks <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>start</dt>
<dd><p>Raster indices from which to initiate dispersal</p></dd>


<dt>rasQuality</dt>
<dd><p>A raster with habitat quality. Currently, must
be scaled from 0 to 1, i.e., a probability of "settling"</p></dd>


<dt>rasAbundance</dt>
<dd><p>A raster where each pixel represents the number
of "agents" or pseudo-agents contained. This number of agents, will
be spread horizontally, and distributed from each pixel
that contains a non-zero non NA value.</p></dd>


<dt>advectionDir</dt>
<dd><p>A single number or <code>RasterLayer</code> in degrees from North = 0
(though it will use radians if all values are <code>abs(advectionDir) &gt; 2 * pi)</code>.
This indicates the direction of advective forcing (i.e., wind).</p></dd>


<dt>advectionMag</dt>
<dd><p>A single number or <code>RasterLayer</code> in distance units of the
<code>rasQuality</code>, e.g., meters, indicating the relative forcing that will
occur. It is imposed on the total event, i.e., if the <code>meanDist</code> is
<code>10000</code>, and <code>advectionMag</code> is <code>5000</code>, then the expected
distance (i.e., <code>63%</code> of agents) will have settled by <code>15000</code> map units.</p></dd>


<dt>meanDist</dt>
<dd><p>A single number indicating the mean distance parameter in map units
(not pixels), for a negative exponential distribution
dispersal kernel (e.g., <code>dexp</code>). This will mean that <code>63%</code> of agents will have
settled at this <code>meanDist</code> (still experimental).</p></dd>


<dt>dispersalKernel</dt>
<dd><p>One of either <code>"exponential"</code> or <code>"weibull"</code>.</p></dd>


<dt>sdDist</dt>
<dd><p>A single number indicating the <code>sd</code> parameter of a two-parameter
<code>dispersalKernel</code>.
Defaults to <code>1</code>, which is the same as the <code>exponential</code> distribution.</p></dd>


<dt>plot.it</dt>
<dd><p>Numeric. With increasing numbers above 0, there will be plots
produced during iterations. Currently, only 0, 1, or 2+ are distinct.</p></dd>


<dt>minNumAgents</dt>
<dd><p>Single numeric indicating the minimum number of agents
to consider all dispersing finished. Default is 50.</p></dd>


<dt>verbose</dt>
<dd><p>Numeric. With increasing numbers above 0, there will be more
messages produced. Currently, only 0, 1, or 2+ are distinct.</p></dd>


<dt>saveStack</dt>
<dd><p>If provided as a character string, it will save each iteration
as part of a <code>rasterStack</code> to disk upon exit.</p></dd>


<dt>skipChecks</dt>
<dd><p>Logical. If <code>TRUE</code>, assertions will be skipped (faster, but could miss
problems)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>data.table</code> with all information used during the spreading</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## these tests are fairly heavy, so don't run during automated tests</span></span></span>
<span class="r-in"><span><span class="co">#########################################################</span></span></span>
<span class="r-in"><span><span class="co"># Simple case, no variation in rasQuality, numeric advectionDir and advectionMag</span></span></span>
<span class="r-in"><span><span class="co">#########################################################</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">maxDim</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span></span>
<span class="r-in"><span>  <span class="va">ras</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">maxDim</span>, <span class="fl">0</span>, <span class="va">maxDim</span><span class="op">)</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">100</span>, vals <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rasQuality</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rasQuality</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="va">rasAbundance</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">rasQuality</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rasAbundance</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>  <span class="co"># startPixel &lt;- middlePixel(rasAbundance)</span></span></span>
<span class="r-in"><span>  <span class="va">startPixel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">rasAbundance</span><span class="op">)</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">rasAbundance</span><span class="op">[</span><span class="va">startPixel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span>  <span class="va">advectionDir</span> <span class="op">&lt;-</span> <span class="fl">70</span></span></span>
<span class="r-in"><span>  <span class="va">advectionMag</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">res</a></span><span class="op">(</span><span class="va">rasAbundance</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">meanDist</span> <span class="op">&lt;-</span> <span class="fl">2600</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Test the dispersal kernel -- create a function</span></span></span>
<span class="r-in"><span>  <span class="va">plotDispersalKernel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">out</span>, <span class="va">meanAdvectionMag</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">out</span><span class="op">[</span>, <span class="va">disGroup</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">distance</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">freqs</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="st">"disGroup"</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">freqs</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span>cumSum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, N <span class="op">=</span> <span class="va">N</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">freqs</span><span class="op">$</span><span class="va">disGroup</span>, <span class="va">freqs</span><span class="op">$</span><span class="va">cumSum</span>, <span class="co"># addTo = "CumulativeNumberSettled",</span></span></span>
<span class="r-in"><span>         main <span class="op">=</span> <span class="st">"Cumulative Number Settled"</span><span class="op">)</span> <span class="co"># can plot the distance X number</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">meanAdvectionMag</span> <span class="op">+</span> <span class="va">meanDist</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">newTitle</span> <span class="op">&lt;-</span> <span class="st">"Number Settled By Distance"</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">freqs</span><span class="op">$</span><span class="va">disGroup</span>, <span class="va">freqs</span><span class="op">$</span><span class="va">N</span>, <span class="co"># addTo = gsub(" ", "", newTitle),</span></span></span>
<span class="r-in"><span>         main <span class="op">=</span> <span class="va">newTitle</span><span class="op">)</span> <span class="co"># can plot the distance X number</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">meanAdvectionMag</span> <span class="op">+</span> <span class="va">meanDist</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># should be 0.63:</span></span></span>
<span class="r-in"><span>    <span class="va">freqs</span><span class="op">[</span><span class="va">disGroup</span> <span class="op">==</span> <span class="va">meanAdvectionMag</span> <span class="op">+</span> <span class="va">meanDist</span>, <span class="va">cumSum</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">freqs</span>, <span class="fl">1</span><span class="op">)</span><span class="op">[</span>, <span class="va">cumSum</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Average habitat quality: "</span>,</span></span>
<span class="r-in"><span>                          <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rasQuality</span><span class="op">[</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          outer <span class="op">=</span> <span class="cn">TRUE</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">spread3</span><span class="op">(</span>rasAbundance <span class="op">=</span> <span class="va">rasAbundance</span>,</span></span>
<span class="r-in"><span>                 rasQuality <span class="op">=</span> <span class="va">rasQuality</span>,</span></span>
<span class="r-in"><span>                 advectionDir <span class="op">=</span> <span class="va">advectionDir</span>,</span></span>
<span class="r-in"><span>                 advectionMag <span class="op">=</span> <span class="va">advectionMag</span>,</span></span>
<span class="r-in"><span>                 meanDist <span class="op">=</span> <span class="va">meanDist</span>, verbose <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                 plot.it <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> assuming that advectionDir is in geographic degrees(i.e., North is 0)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 29942.6974241127</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 29845.2355120556</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 29684.8907058857</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 28961.0363094562</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 28689.172882837</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 6</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 28297.5381929262</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 7</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 27874.7434601112</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 8</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 26484.7181518992</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 9</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 25582.8367937818</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 24950.0287991057</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 11</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 23810.3470626647</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 12</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 23138.6878916629</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 13</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 22478.8630156612</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 14</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 21493.294194617</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 15</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 20878.3755159988</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 16</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 20230.8132430021</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 17</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 19558.2859208612</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 18</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 18798.6791665058</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 19</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 18114.4685714799</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 20</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 17335.5307185944</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 21</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 16617.7831503639</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 22</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 15886.9462151914</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 23</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 15193.9920401682</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 24</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 14475.3920643484</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 13773.1118090256</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 26</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 13098.0798618491</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 27</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 12267.94522178</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 28</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 11605.0397688509</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 29</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 10952.5137443267</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 30</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 9991.87560873532</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 31</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 9320.07536604412</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 32</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 8608.22893176744</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 33</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 8019.3137539911</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 34</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 7419.6941039023</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 35</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 6824.49671291095</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 36</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 6317.9586758525</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 37</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 5865.93380825119</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 38</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 5377.47629354724</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 39</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 4919.23529026206</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 40</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 4529.38133634955</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 41</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 4118.66865850671</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 42</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 3713.52728051165</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 43</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 3336.93962976748</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 44</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 2980.35984067639</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 45</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 2697.3979402356</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 46</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 2415.25223056504</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 47</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 2116.82733879199</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 48</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 1918.09641472157</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 49</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 1647.41511007985</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 50</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 1442.02030855928</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 51</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 1252.53030232797</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 52</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 1068.17138783792</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 53</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 898.580870314861</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 54</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 737.905987640094</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 55</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 656.285745925141</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 56</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 514.584219321668</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 57</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 440.522016969407</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 58</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 388.674735204424</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 59</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 295.769875692062</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 60</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 215.171705314287</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 61</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 178.493658565594</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 62</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 97.6754223744511</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 63</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number still dispersing 21.8713131945417</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">plotDispersalKernel</span><span class="op">(</span><span class="va">out</span>, <span class="va">advectionMag</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spread3-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="spread3-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The next examples are potentially time consuming; avoid on automated testing</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co">#########################################################</span></span></span>
<span class="r-in"><span>    <span class="co">### The case of variable quality raster</span></span></span>
<span class="r-in"><span>    <span class="co">#########################################################</span></span></span>
<span class="r-in"><span>    <span class="va">rasQuality</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"rasQuality.tif"</span>,</span></span>
<span class="r-in"><span>                                          package <span class="op">=</span> <span class="st">"SpaDES.tools"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">rasQuality</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"targetCRS.rds"</span>, package <span class="op">=</span> <span class="st">"SpaDES.tools"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/pkg/terra/man/serialize.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/methods/slot.html" class="external-link">slot</a></span><span class="op">(</span><span class="st">"projargs"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mask</span> <span class="op">&lt;-</span> <span class="va">rasQuality</span> <span class="op">&lt;</span> <span class="fl">5</span></span></span>
<span class="r-in"><span>    <span class="va">rasQuality</span><span class="op">[</span><span class="va">mask</span><span class="op">[</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/pkg/terra/man/match.html" class="external-link">%in%</a></span> <span class="cn">TRUE</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>    <span class="co"># rescale so min is 0.75 and max is 1</span></span></span>
<span class="r-in"><span>    <span class="va">rasQuality</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">rasQuality</span><span class="op">[</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="fu">reproducible</span><span class="fu">::</span><span class="fu"><a href="https://reproducible.predictiveecology.org/reference/terra-migration.html" class="external-link">maxFn</a></span><span class="op">(</span><span class="va">rasQuality</span><span class="op">)</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">4</span></span></span>
<span class="r-in"><span>    <span class="va">rasAbundance</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">rasQuality</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">rasAbundance</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>    <span class="va">startPixel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">rasAbundance</span><span class="op">)</span><span class="op">)</span>, <span class="fl">300</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">rasAbundance</span><span class="op">[</span><span class="va">startPixel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span>    <span class="va">advectionDir</span> <span class="op">&lt;-</span> <span class="fl">75</span></span></span>
<span class="r-in"><span>    <span class="va">advectionMag</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">res</a></span><span class="op">(</span><span class="va">rasAbundance</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">meanDist</span> <span class="op">&lt;-</span> <span class="fl">2600</span></span></span>
<span class="r-in"><span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">spread3</span><span class="op">(</span>rasAbundance <span class="op">=</span> <span class="va">rasAbundance</span>,</span></span>
<span class="r-in"><span>                   rasQuality <span class="op">=</span> <span class="va">rasQuality</span>,</span></span>
<span class="r-in"><span>                   advectionDir <span class="op">=</span> <span class="va">advectionDir</span>,</span></span>
<span class="r-in"><span>                   advectionMag <span class="op">=</span> <span class="va">advectionMag</span>,</span></span>
<span class="r-in"><span>                   meanDist <span class="op">=</span> <span class="va">meanDist</span>, verbose <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                   plot.it <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fu">plotDispersalKernel</span><span class="op">(</span><span class="va">out</span>, <span class="va">advectionMag</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">###############################################################################</span></span></span>
<span class="r-in"><span>    <span class="co">### The case of variable quality raster, raster for advectionDir &amp; advectionMag</span></span></span>
<span class="r-in"><span>    <span class="co">###############################################################################</span></span></span>
<span class="r-in"><span>    <span class="va">maxDim</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span></span>
<span class="r-in"><span>    <span class="va">ras</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">maxDim</span>, <span class="fl">0</span>, <span class="va">maxDim</span><span class="op">)</span><span class="op">)</span>, res <span class="op">=</span> <span class="fl">100</span>, vals <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">rasQuality</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">rasQuality</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">rasAbundance</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">rasQuality</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">rasAbundance</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span>    <span class="co"># startPixel &lt;- middlePixel(rasAbundance)</span></span></span>
<span class="r-in"><span>    <span class="va">startPixel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">rasAbundance</span><span class="op">)</span><span class="op">)</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">rasAbundance</span><span class="op">[</span><span class="va">startPixel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># raster for advectionDir</span></span></span>
<span class="r-in"><span>    <span class="va">advectionDir</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"advectionDir.tif"</span>,</span></span>
<span class="r-in"><span>                                            package <span class="op">=</span> <span class="st">"SpaDES.tools"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">advectionDir</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">rasQuality</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># rescale so min is 0.75 and max is 1</span></span></span>
<span class="r-in"><span>    <span class="va">advectionDir</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">advectionDir</span><span class="op">[</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="fu">reproducible</span><span class="fu">::</span><span class="fu"><a href="https://reproducible.predictiveecology.org/reference/terra-migration.html" class="external-link">maxFn</a></span><span class="op">(</span><span class="va">advectionDir</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">180</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># raster for advectionMag</span></span></span>
<span class="r-in"><span>    <span class="va">advectionMag</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"advectionMag.tif"</span>,</span></span>
<span class="r-in"><span>                                            package <span class="op">=</span> <span class="st">"SpaDES.tools"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">advectionMag</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">rasQuality</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># rescale so min is 0.75 and max is 1</span></span></span>
<span class="r-in"><span>    <span class="va">advectionMag</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">advectionMag</span><span class="op">[</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="fu">reproducible</span><span class="fu">::</span><span class="fu"><a href="https://reproducible.predictiveecology.org/reference/terra-migration.html" class="external-link">maxFn</a></span><span class="op">(</span><span class="va">advectionMag</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">600</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">spread3</span><span class="op">(</span>rasAbundance <span class="op">=</span> <span class="va">rasAbundance</span>,</span></span>
<span class="r-in"><span>                   rasQuality <span class="op">=</span> <span class="va">rasQuality</span>,</span></span>
<span class="r-in"><span>                   advectionDir <span class="op">=</span> <span class="va">advectionDir</span>,</span></span>
<span class="r-in"><span>                   advectionMag <span class="op">=</span> <span class="va">advectionMag</span>,</span></span>
<span class="r-in"><span>                   meanDist <span class="op">=</span> <span class="va">meanDist</span>, verbose <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                   plot.it <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">advectionDir</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Wind direction"</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">advectionMag</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Wind speed"</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rasAbundance</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Initial abundances"</span></span></span>
<span class="r-in"><span>      <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">advectionDir</span>, <span class="va">advectionMag</span>, <span class="va">rasAbundance</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>      <span class="fu">plotDispersalKernel</span><span class="op">(</span><span class="va">out</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">advectionMag</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">#########################################</span></span></span>
<span class="r-in"><span>    <span class="co"># save iterations to a stack to make animated GIF</span></span></span>
<span class="r-in"><span>    <span class="co">########################################</span></span></span>
<span class="r-in"><span>    <span class="va">tmpStack</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"stackToAnimate"</span>, fileext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">spread3</span><span class="op">(</span>rasAbundance <span class="op">=</span> <span class="va">rasAbundance</span>,</span></span>
<span class="r-in"><span>                   rasQuality <span class="op">=</span> <span class="va">rasQuality</span>,</span></span>
<span class="r-in"><span>                   advectionDir <span class="op">=</span> <span class="va">advectionDir</span>,</span></span>
<span class="r-in"><span>                   advectionMag <span class="op">=</span> <span class="va">advectionMag</span>,</span></span>
<span class="r-in"><span>                   meanDist <span class="op">=</span> <span class="fl">2600</span>, verbose <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                   plot.it <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>, saveStack <span class="op">=</span> <span class="va">tmpStack</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## This animates the series of images into an animated GIF</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/animation/" class="external-link">animation</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">tmpStack</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">gifName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"animation.gif"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>      <span class="co"># Only works on some systems; may need to configure</span></span></span>
<span class="r-in"><span>      <span class="co"># Works on Windows without system adjustments</span></span></span>
<span class="r-in"><span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span>, <span class="st">"windows"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/pkg/animation/man/saveGIF.html" class="external-link">saveGIF</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="fl">0.1</span>, movie.name <span class="op">=</span> <span class="va">gifName</span>, expr <span class="op">=</span> <span class="op">{</span></span></span>
<span class="r-in"><span>          <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">out2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Eliot J B McIntire, Alex M Chubaty.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

